## Модуль "curl:utils/content_types"

### Предоставляет набор функций для сериализации и десериализации двоичных и текстовых данных


Проверяет, зарегистрирован ли тип с указанным идентификатором
```lua
function content_types.has_content_type(id)
```

Сериализует контент через функцию-сериализатор указанного типа и возвращает сериализованные данные в формате типа
```lua
function content_types.serialize(id, content)
```

Десериализует сериализованные данные в формате типа через функцию-десериализатор указанного типа и возвращает десериализованный контент
```lua
function content_types.deserialize(id, data)
```

Читает данные из файла, а затем десериализует их через функцию-десериализатор указанного типа и возвращает результат
```lua
function content_types.read_from_file(id, path)
```

Сериализует контент через функцию-сериализатор указанного типа и записывает сериализованные данные в файл
```lua
function content_types.write_to_file(id, path, content)
```

Возвращает **true**, если тип с указанным идентификатором является текстовым
```lua
function content_types.is_text_format(id)
```

Возвращает **true**, если тип с указанным идентификатором является двоичным
```lua
function content_types.is_binary_format(id)
```

Возвращает функцию-десериализатор данных для указанного типа. Возвращённая функция принимает сериализованные данные в формате типа, и возвращает десериализованные
```lua
function content_types.get_reader(id)
```

Возвращает функцию-сериализатор данных для указанного типа. Возвращённая функция принимает десериализованные данные, и возвращает сериализованные в формате типа
```lua
function content_types.get_writer(id)
```

Возвращает функцию, которая ничего не принимает и возвращает десериализованное значение по-умолчанию для указанного типа
```lua
function content_types.get_default_value_provider(id)
```

Регистрирует пользовательский тип контента.

**reader**, **writer** - функции-сериализатор/десериализатор. Если не указать, то будет подставлена функция, которая будет возвращать первый аргумент.

**defProvider** - функция, возвращающая десериализованное значение по-умолчанию для этого типа.

**isTextFormat** - значение, определяющее базовый формат типа. Если указать **true** - текстовый, **false** - двоичный.

```lua
function content_types.register_content_type(id, reader, writer, defProivder, isTextFormat)
```

#### Встроенные типы контента из коробки
**text** - Обыкновенный текст;  
**binary** - Обыкновенный массив байт;  
**json** - **JSON** обьект;  
**toml** - **TOML** обьект;  
**vcbjson** - **VoxelCore BJSON** обьект;  
**file** - Псевдотип, который используется для представления файлов.

Также присутствуют типы **dirty_json** и **dirty_toml**, они были созданы из-за недостаточной надёжности встроенных библиотек **toml**, **json** в скриптинге. Перед тем как попасть к ним функцию десериализации и после сериализации, текст проходит через специальные модули **curl:utils/combers/json_comber** (для **JSON**) и **curl:utils/combers/comber** (для **TOML**) которые "причёсывают" текст, чтобы он стал валидным для парсинга через библиотеку или валидным для отправки. Скорее всего эти два типа будут неактуальны в 0.24 в связи с фиксами.
